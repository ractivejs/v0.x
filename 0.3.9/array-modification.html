<!doctype html>
<html lang='en-GB'>
<head>
	<meta charset='utf-8'>
	<meta http-equiv='X-UA-Compatible' content='IE=Edge,chrome=1'>

	<title> Array modification | Docs | Ractive.js </title >

	<meta name='viewport' content='width=device-width, initial-scale=1, maximum-scale=1'>

	<link rel='icon' type='image/png' href='../assets/favicon.png'>
	<link rel='stylesheet' href='../min.css'>

	<!--[if lte IE 8]>
		<script src='../assets/respond.min.js'></script>
		<script src='../assets/html5shiv.min.js'></script>
	<![endif]-->

</head>

<body class='example'>

	<nav>
	<div class='nav-inner'>
		<a href='http://ractivejs.org'>Ractive.js</a>

		<ul>
			<li><a href='http://ractivejs.org/60-second-setup'>60 second setup</a></li>
			<li><a href='http://learn.ractivejs.org'>Tutorials</a></li>
			<li><a href='http://examples.ractivejs.org'>Examples</a></li>
			<li class="selected"><a href='http://docs.ractivejs.org'>Docs</a></li>
			<li><a href='http://docs.ractivejs.org/latest/plugins'>Plugins</a></li>
			<li><a href='http://blog.ractivejs.org'>Blog</a></li>
			<li class='github-small'><a href='https://github.com/ractivejs/ractive'>GitHub</a></li>
		</ul>

		<a class='github-wide' href='https://github.com/ractivejs/ractive'>GitHub</a>

		<button id='nav-toggle'>&#9776;</button>
	</div>
</nav>


	<main>
		<div class='content'>
			<header class='main-header'>
				<h1>Array modification</h1>
				<a class='edit-link' href='https://github.com/ractivejs/docs.ractivejs.org/edit/master/docs/0.3.9/Array modification.md.hbs'>edit this page</a>
			</header>

			<p>By default, Ractive will intercept the <em>mutator methods</em> (<code>pop</code>, <code>push</code>, <code>shift</code>, <code>unshift</code>, <code>splice</code>, <code>sort</code> and <code>reverse</code>) of arrays that it <a href="dependants">depends on</a> for more convenient data binding.</p>
<p>Consider the following:</p>
<pre><code class="language-html">&lt;ul&gt;
  {{#list}}
    &lt;li&gt;[object Object]&lt;/li&gt;
  {{/list}}
&lt;/ul&gt;</code></pre>
<pre><code class="language-js">list = [ <span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span> ];

ractive = <span class="keyword">new</span> Ractive({
  el: myContainer,
  template: myTemplate,
  data: { list: list }
});

list.push( <span class="string">'d'</span> ); <span class="comment">// adds a new list item - &lt;li&gt;d&lt;/li&gt;</span></code></pre>
<p>You can disable this behaviour by passing in <code>modifyArrays: false</code> as an <a href="initialisation-options">initialisation Options</a></p>
<h2 id="how-it-works">How it works</h2>
<p>Don&#39;t worry, we&#39;re not modifying <code>Array.prototype</code>. (What do you think this is, <a href="http://emberjs.com/guides/configuring-ember/disabling-prototype-extensions/">Ember</a>? :-)</p>
<p>Instead, we&#39;re using a technique called <a href="http://perfectionkills.com/how-ecmascript-5-still-does-not-allow-to-subclass-an-array/#wrappers_prototype_chain_injection">prototype chain injection</a>, which allows us to remain performant and memory-efficient without mucking about extending native objects.</p>
<p>This uses the non-standard (but very unlikely to disappear!) <code>__proto__</code> property. That might seem kludgy, but if <a href="http://bost.ocks.org/mike/selection/#subclass">Mike Bostock thinks it&#39;s okay</a> then that&#39;s good enough for us.</p>
<p>Older browsers (I&#39;m looking at you, IE8) don&#39;t support <code>__proto__</code> - in these cases, we simply add the wrapped methods as properties of the array itself.</p>
<p>As well as intercepting or wrapping the mutator methods, Ractive adds a (non-enumerable, in modern browsers) <code>_ractive</code> property to arrays, which contains information about which Ractive instances depend on the array, and which keypaths it is assigned to.</p>
<h2 id="hygiene">Hygiene</h2>
<p>When an array is no longer depended on by any Ractive instances, we can revert it to its normal state - resetting its prototype (if we used prototype chain injection) or deleting the wrapped methods (if we&#39;re in a crap browser), and removing the <code>_ractive</code> property.</p>
<h2 id="performance-and-ui-benefits">Performance and UI benefits</h2>
<p>As well as convenience, using arrays like this helps Ractive make smart decisions about how to update the DOM. Continuing the example above, compare these two alternative methods of inserting a new item at the <em>start</em> of our list:</p>
<pre><code class="language-js"><span class="comment">// at the moment, list = [ 'a', 'b', 'c', 'd' ]</span>

<span class="comment">// 1. Reset the list:</span>
ractive.set( <span class="string">'list'</span>, [ <span class="string">'z'</span>, <span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>, <span class="string">'d'</span> ] )

<span class="comment">// 2. Use `unshift`:</span>
list.unshift( <span class="string">'z'</span> );</code></pre>
<p>In the first example, Ractive will see that the content of the first list item has changed from <code>&#39;a&#39;</code> to <code>&#39;z&#39;</code>, and that the second has changed from <code>&#39;b&#39;</code> to <code>&#39;a&#39;</code>, and so on, and update the DOM accordingly. It will also see that there is now a fifth item, so will append <code>&lt;li&gt;d&lt;/li&gt;</code> to the list.</p>
<p>In the second example, Ractive will understand that all it needs to do is insert <code>&lt;li&gt;z&lt;/li&gt;</code> at the start of the list, leaving everything else untouched.</p>
<p>This is particularly important if you&#39;re using <a href="transitions">transitions</a>, as it will be obvious to the user which elements are being added and removed.</p>
<p>Note that if <code>list.unshift(&#39;z&#39;)</code> isn&#39;t an option, you could use <a href="ractive-merge">ractive.merge()</a> to achieve the same effect.</p>

		</div>

		<aside class="left-nav">
			<section>
	<h1>Introduction</h1>
	<ul>
		<li><a href="get-started">Get started</a></li>
		<li><a href="get-support">Get support</a></li>
		<li><a href="contributing">Contributing</a></li>
	</ul>
</section>

<section>
	<h1>API Reference</h1>
	<h2>new Ractive(...)</h2>
	<ul>
		<li><a href="initialisation-options">Initialisation options</a></li>
	</ul>

	<h2>Instance methods</h2>
	<ul>
		<li><a href="ractive-animate">ractive.animate()</a></li>
		<li><a href="ractive-find">ractive.find()</a></li>
		<li><a href="ractive-findall">ractive.findAll()</a></li>
		<li><a href="ractive-fire">ractive.fire()</a></li>
		<li><a href="ractive-get">ractive.get()</a></li>
		<li><a href="ractive-merge">ractive.merge()</a></li>
		<li><a href="ractive-observe">ractive.observe()</a></li>
		<li><a href="ractive-off">ractive.off()</a></li>
		<li><a href="ractive-on">ractive.on()</a></li>
		<li><a href="ractive-set">ractive.set()</a></li>
		<li><a href="ractive-teardown">ractive.teardown()</a></li>
		<li><a href="ractive-tohtml">ractive.toHTML()</a></li>
		<li><a href="ractive-update">ractive.update()</a></li>
		<li><a href="ractive-updatemodel">ractive.updateModel()</a></li>
	</ul>

	<h2>Instance properties</h2>
	<ul>
		<li><a href="ractive-nodes">ractive.nodes</a></li>
		<li><a href="ractive-transitions-instance">ractive.transitions</a></li>
		<li><a href="ractive-partials-instance">ractive.partials</a></li>
	</ul>

	<h2>Static methods</h2>
	<ul>
		<li><a href="ractive-parse">Ractive.parse()</a></li>
		<li><a href="ractive-extend">Ractive.extend()</a></li>
	</ul>

	<h2>Static properties</h2>
	<ul>
		<li><a href="ractive-defaults">Ractive.defaults</a></li>
	</ul>
</ul>

<section>
	<h1>Plugins</h1>
	<ul>
		<li><a href="plugins">List of plugins</a></li>
		<li><a href="writing-plugins">Writing plugins</a></li>
	</ul>
</section>

<section>
	<h1>Glossary</h1>
	<ul>
		<li><a href="adaptors">Adaptors</a></li>
		<li><a href="array-modification">Array modification</a></li>
		<li><a href="components">Components</a></li>
		<li><a href="decorators">Decorators</a></li>
		<li><a href="dependants">Dependants</a></li>
		<li><a href="expressions">Expressions</a></li>
		<li><a href="events">Events</a></li>
		<li><a href="keypaths">Keypaths</a></li>
		<li><a href="magic-mode">Magic mode</a></li>
		<li><a href="mustaches">Mustaches</a></li>
		<li><a href="observers">Observers</a></li>
		<li><a href="parallel-dom">Parallel DOM</a></li>
		<li><a href="partials">Partials</a></li>
		<li><a href="references">References</a></li>
		<li><a href="templates">Templates</a></li>
		<li><a href="transitions">Transitions</a></li>
		<li><a href="two-way-binding">Two-way binding</a></li>
	</ul>
</section>

<section>
	<h1>Specific versions</h1>

	<ul>
		<li><a href='../edge'>edge</a></li>
		<li><a href='../0.7'>0.7</a></li>
		<li><a href='../0.6'>0.6</a></li>
		<li><a href='../0.5'>0.5</a></li>
		<li><a href='../0.4.0'>0.4.0</a></li>
		<li><a href='../0.3.9'>0.3.9</a></li>
	</ul>
</section>

		</aside>
	</main>

	<footer>
	<p>Ractive.js is a free and open source project released under the MIT license.</p>
</footer>


	<script>
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

	ga('create', 'UA-5602942-6', 'ractivejs.org');
	ga('send', 'pageview');
</script>


	<script src='../assets/nav.js'></script>

</body>
</html>
