<!doctype html>
<html lang='en-GB'>
<head>
	<meta charset='utf-8'>
	<meta http-equiv='X-UA-Compatible' content='IE=Edge,chrome=1'>

	<title> Computed Properties | Docs | Ractive.js </title >

	<meta name='viewport' content='width=device-width'>

	<link rel='icon' type='image/png' href='../assets/favicon.png'>
	<link rel='stylesheet' href='../min.css'>

	<!--[if lte IE 8]>
		<script src='../assets/respond.min.js'></script>
		<script src='../assets/html5shiv.min.js'></script>
	<![endif]-->

</head>

<body class='example'>

	<nav>
	<div class='nav-inner'>
		<a href='http://ractivejs.org'>Ractive.js</a>

		<ul>
			<li><a href='http://ractivejs.org/60-second-setup'>60 second setup</a></li>
			<li><a href='http://learn.ractivejs.org'>Tutorials</a></li>
			<li><a href='http://examples.ractivejs.org'>Examples</a></li>
			<li class="selected"><a href='http://docs.ractivejs.org'>Docs</a></li>
			<li><a href='http://docs.ractivejs.org/latest/plugins'>Plugins</a></li>
			<li><a href='http://blog.ractivejs.org'>Blog</a></li>
			<li class='github-small'><a href='https://github.com/ractivejs/ractive'>GitHub</a></li>
		</ul>

		<a class='github-wide' href='https://github.com/ractivejs/ractive'>GitHub</a>

		<button id='nav-toggle'>&#9776;</button>
	</div>
</nav>


	<main>
		<div class='content'>
			<header class='main-header'>
				<h1>Computed Properties</h1>
				<a class='edit-link' href='https://github.com/ractivejs/docs.ractivejs.org/edit/master/docs/0.6/Computed Properties.md.hbs'>edit this page</a>
			</header>

			<p>The idea is fairly simple: you can define computed properties that update reactively based on their dependencies. In previous versions you may have done something as follows.</p>
<pre><code class="language-js">ractive = <span class="keyword">new</span> Ractive({
  el: <span class="string">'body'</span>,
  template: <span class="string">'{{width}} * {{height}} = {{ area() }}'</span>, <span class="comment">// note the function invocation</span>
  data: {
    width: <span class="number">100</span>,
    height: <span class="number">100</span>,
    area: <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span> <span class="keyword">return</span> <span class="keyword">this</span>.get( <span class="string">'width'</span> ) * <span class="keyword">this</span>.get( <span class="string">'height'</span> ); }
  }
});</code></pre>
<p>That&#39;s nice and all - the <code>{{ area() }}</code> mustache updates reactively as <code>width</code> and <code>height</code> change - but it&#39;s limited. To get the area value programmatically you&#39;d have to do something like...</p>
<pre><code class="language-js">area = ractive.get(<span class="string">'area'</span>).call(ractive);</code></pre>
<p>...which effectively prevents you from composing computed values together in any meaningful way. And you can&#39;t &#39;observe&#39; the area outside of the template, without doing something like this:</p>
<pre><code class="language-js">ractive.observe( <span class="string">'width height'</span>, <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
    <span class="keyword">var</span> area = <span class="keyword">this</span>.get( <span class="string">'width'</span> ) * <span class="keyword">this</span>.get( <span class="string">'height'</span> );
    doSomething( area );
});</code></pre>
<h2 id="computed-properties-to-the-rescue">Computed properties to the rescue</h2>
<p>Now, you can do</p>
<pre><code class="language-js">ractive = <span class="keyword">new</span> Ractive({
  el: <span class="string">'body'</span>,
  template: <span class="string">'{{width}} * {{height}} = {{area}}'</span>, <span class="comment">// `area` looks like a regular property</span>
  data: {
    width: <span class="number">100</span>,
    height: <span class="number">100</span>
  },
  computed: {
    area: <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span> <span class="keyword">return</span> <span class="keyword">this</span>.get( <span class="string">'width'</span> ) * <span class="keyword">this</span>.get( <span class="string">'height'</span> ); }
  }
});</code></pre>
<p>With this, the <code>area</code> property can be treated like any other. It will update reactively (because the calls to <code>ractive.get()</code> tell Ractive that it should be recomputed when <code>width</code> or <code>height</code> change), so you can do...</p>
<pre><code class="language-js">ractive.observe( <span class="string">'area'</span>, doSomething );</code></pre>
<p>...instead of manually recalculating it. And computed values can depend on other computed values, and so on (before anyone asks, we&#39;re not doing a topological sort or anything fancy like that - in real world scenarios I&#39;d expect the overhead of doing the sort to be greater than the cost of occasionally recomputing a node in the dependency graph more times than is required).</p>
<h2 id="compact-syntax">Compact syntax</h2>
<p>The syntax used above, where each computed property is defined as a function, gives you a lot of flexibility. But there&#39;s a more compact string syntax you can use:</p>
<pre><code class="language-js">ractive = <span class="keyword">new</span> Ractive({
  ...,
  computed: {
    area: <span class="string">'${width} * ${height}'</span>
  }
});</code></pre>
<p>This string is turned into a function with the <code>Function</code> constructor (which unfortunately means it isn&#39;t <a href="https://developer.mozilla.org/en-US/docs/Security/CSP">CSP compliant</a>) - any <code>${...}</code> blocks are basically turned into <code>ractive.get(&#39;...&#39;)</code>, so it works exactly the same way. Needless to say you can use any JavaScript here - <code>${foo}.toUpperCase()</code>, <code>Math.round(${num})</code>, and so on.</p>
<h2 id="setting-computed-values">Setting computed values</h2>
<p>By default, computed values are read-only, and if you try to <code>ractive.set(&#39;someComputedProperty&#39;)</code> an error will be thrown. But you can use a third syntax option which allows you to declare a <code>set()</code> method:</p>
<pre><code class="language-js">ractive = <span class="keyword">new</span> Ractive({
  data: { firstname: <span class="string">'Douglas'</span>, lastname: <span class="string">'Crockford'</span> },
  computed: {
    fullname: {
      get: <span class="string">'${firstname} + " " + ${lastname}'</span>, <span class="comment">// or use the function syntax</span>
      set: <span class="function"><span class="keyword">function</span> <span class="params">( fullname )</span> {</span>
        <span class="keyword">var</span> names = fullname.split( <span class="string">' '</span> );

        <span class="keyword">this</span>.set({
          firstname: names[<span class="number">0</span>] || <span class="string">''</span>,
          lastname: names[<span class="number">1</span>] || <span class="string">''</span>
        });
      }
    }
  }
});

ractive.set( <span class="string">'fullname'</span>, <span class="string">'Rich Harris'</span> );

ractive.get( <span class="string">'firstname'</span> ); <span class="comment">// Rich</span>
ractive.get( <span class="string">'lastname'</span> ); <span class="comment">// Harris</span></code></pre>
<h2 id="components">Components</h2>
<p>You can, of course, declare computed values on components:</p>
<pre><code class="language-js">Box = Ractive.extend({
  template: boxTemplate,
  computed: { area: <span class="string">'${width} * ${height}'</span> }
});

box = <span class="keyword">new</span> Box({
  ...,
  data: { width: <span class="number">20</span>, height: <span class="number">40</span> }
});

box.get( <span class="string">'area'</span> ); <span class="comment">// 800</span></code></pre>
<p>Additional computed properties can be declared on the instance:</p>
<pre><code class="language-js">box2 = <span class="keyword">new</span> Box({
  ...,
  data: { width: <span class="number">20</span>, height: <span class="number">40</span>, depth: <span class="number">60</span> },
  computed: { volume: <span class="string">'${area} * ${depth}'</span> }
});

box2.get( <span class="string">'area'</span> ); <span class="comment">// 800</span>
box2.get( <span class="string">'volume'</span> ); <span class="comment">// 48000</span></code></pre>
<h2 id="data-context-for-computed-properties">Data context for computed properties</h2>
<p>Computed properties can only be calculated for the instance context as a whole. You can&#39;t, for example, directly
compute a value for each member of an array:</p>
<pre><code class="language-js"><span class="keyword">new</span> Ractive({
  template: <span class="string">'{{#boxes}}{{area}}{{/}}'</span>,
  data: {
    boxes: [
      { width: <span class="number">20</span>, height: <span class="number">40</span> },
      { width: <span class="number">30</span>, height: <span class="number">45</span> },
      { width: <span class="number">20</span>, height: <span class="number">20</span> }
    ]
  },
  <span class="comment">// there's no way to specify this for "each" box :(</span>
  computed: { area: <span class="string">'${width} * ${height}'</span> }
});</code></pre>
<p>The solution is to either use a function that calculates the value for each member:</p>
<pre><code class="language-js">  template: <span class="string">'{{#boxes:b}}{{ getArea(b) }}{{/}}'</span>,
  data: {
    boxes: [
      { width: <span class="number">20</span>, height: <span class="number">40</span> },
      { width: <span class="number">30</span>, height: <span class="number">45</span> },
      { width: <span class="number">20</span>, height: <span class="number">20</span> }
    ],
    getArea: <span class="function"><span class="keyword">function</span> <span class="params">( i )</span> {</span>
      <span class="keyword">var</span> box = <span class="keyword">this</span>.get( <span class="string">'boxes.'</span> + i );
      <span class="keyword">return</span> box.width * box.area;
    }
  }</code></pre>
<p>Or leverage a component to &quot;scope&quot; the data to each item:</p>
<pre><code class="language-js">Box = Ractive.extend({
  template: boxTemplate,
  computed: { area: <span class="string">'${width} * ${height}'</span> }
});

<span class="keyword">new</span> Ractive({
  template: <span class="string">'{{#boxes}}&lt;box/&gt;{{/}}'</span>,
  data: {
    boxes: [
      { width: <span class="number">20</span>, height: <span class="number">40</span> },
      { width: <span class="number">30</span>, height: <span class="number">45</span> },
      { width: <span class="number">20</span>, height: <span class="number">20</span> }
    ]
  },
  components: { box: Box }
});</code></pre>

		</div>

		<aside class="left-nav">
			<section>
	<h1>Introduction</h1>
	<ul>
		<li><a href="get-started">Get started</a></li>
		<li><a href="tips">Tips</a></li>
		<li><a href="get-support">Get support</a></li>
		<li><a href="contributing">Contributing</a></li>
		<li><a href="get-started-with-node-js">Get started with node.js</a></li>
		<li><a href="migrating">Migrating from previous versions</a></li>
	</ul>
</section>

<section>
	<h1>Configuration</h1>
	<ul>
		<li><a href="options">Options</a></li>
		<li><a href="ractive-defaults">Defaults</a></li>
		<li><a href="advanced-configuration">Advanced configuration</a></li>
	</ul>
</section>
<section>
	<h1>Core Concepts</h1>
	<h2>Templates</h2>
	<ul>
		<li><a href="templates">Templates</a></li>
		<li><a href="mustaches">Mustaches</a></li>
		<li><a href="references">References</a></li>
		<li><a href="expressions">Expressions</a></li>
		<li><a href="keypaths">Keypaths</a></li>
		<li><a href="partials">Partials</a></li>
		<li><a href="decorators">Decorators</a></li>
	</ul>
	<h2>Data & Binding</h2>
	<ul>
		<li><a href="two-way-binding">Two-way binding</a></li>
		<li><a href="magic-mode">Magic mode</a></li>
		<li><a href="dependants">Dependants</a></li>
		<li><a href="array-modification">Array modification</a></li>
		<li><a href="computed-properties">Computed Properties</a></li>
		<li><a href="observers">Observers</a></li>
		<li><a href="adaptors">Adaptors</a></li>
		<li><a href="parallel-dom">Parallel DOM</a></li>
	</ul>
	<h2>Events</h2>
	<ul>
		<li><a href="events-overview">Overview</a></li>
		<li><a href="event-directives">Event directives</a></li>
		<li><a href="proxy-events">Proxy events</a></li>
		<li><a href="method-calls">Method calls</a></li>
		<li><a href="publish-subscribe">Publish/subscribe</a></li>
		<li><a href="event-bubbling">Event bubbling</a></li>
		<li><a href="lifecycle-events">Lifecycle events</a></li>
	</ul>
	<h2>Transitions and Animations</h2>
	<ul>
		<li><a href="transitions">Transitions</a></li>
		<li><a href="promises">Promises</a></li>
		<li><a href="ractive-easing">Easings</a></li>
	</ul>
	<h2>Components</h2>
	<ul>
		<li><a href="components">Components</a></li>
	</ul>
</section>
<section>
	<h1>API Reference</h1>
	<h2>Constructor</h2>
	<ul>
		<li><a href="new-ractive">new Ractive(...)</a></li>
	</ul>
	<h2>Instance methods</h2>
	<ul>
		<li><a href="ractive-add">ractive.add()</a></li>
		<li><a href="ractive-animate">ractive.animate()</a></li>
		<li><a href="ractive-detach">ractive.detach()</a></li>
		<li><a href="ractive-find">ractive.find()</a></li>
		<li><a href="ractive-findall">ractive.findAll()</a></li>
		<li><a href="ractive-findallcomponents">ractive.findAllComponents()</a></li>
		<li><a href="ractive-findcomponent">ractive.findComponent()</a></li>
		<li><a href="ractive-fire">ractive.fire()</a></li>
		<li><a href="ractive-get">ractive.get()</a></li>
		<li><a href="ractive-insert">ractive.insert()</a></li>
		<li><a href="ractive-merge">ractive.merge()</a></li>
		<li><a href="ractive-observe">ractive.observe()</a></li>
		<li><a href="ractive-off">ractive.off()</a></li>
		<li><a href="ractive-on">ractive.on()</a></li>
		<li><a href="ractive-pop">ractive.pop()</a></li>
		<li><a href="ractive-push">ractive.push()</a></li>
		<li><a href="ractive-render">ractive.render()</a></li>
		<li><a href="ractive-reset">ractive.reset()</a></li>
		<li><a href="ractive-set">ractive.set()</a></li>
		<li><a href="ractive-shift">ractive.shift()</a></li>
		<li><a href="ractive-splice">ractive.splice()</a></li>
		<li><a href="ractive-subtract">ractive.subtract()</a></li>
		<li><a href="ractive-teardown">ractive.teardown()</a></li>
		<li><a href="ractive-toggle">ractive.toggle()</a></li>
		<li><a href="ractive-tohtml">ractive.toHTML()</a></li>
		<li><a href="ractive-unrender">ractive.unrender()</a></li>
		<li><a href="ractive-unshift">ractive.unshift()</a></li>
		<li><a href="ractive-update">ractive.update()</a></li>
		<li><a href="ractive-updatemodel">ractive.updateModel()</a></li>
	</ul>
	<h2>Instance properties</h2>
	<ul>
		<li><a href="ractive-nodes">ractive.nodes</a></li>
		<li><a href="ractive-transitions-instance">ractive.transitions</a></li>
		<li><a href="ractive-partials-instance">ractive.partials</a></li>
	</ul>
	<h2>Static methods</h2>
	<ul>
		<li><a href="ractive-extend">Ractive.extend()</a></li>
		<li><a href="ractive-parse">Ractive.parse()</a></li>
	</ul>
	<h2>Static properties</h2>
	<ul>
		<li><a href="ractive-defaults">Ractive.defaults</a></li>
		<li><a href="ractive-easing">Ractive.easing</a></li>
	</ul>
</ul>
</section>
<section>
	<h1>Plugins</h1>
	<h2>Using</h2>
	<ul>
		<li><a href="plugins">List of plugins</a></li>
	</ul>
	<h2>Writing</h2>
	<ul>
		<li><a href="writing-adaptor-plugins">Adaptors</a></li>
		<li><a href="writing-decorator-plugins">Decorators</a></li>
		<li><a href="writing-event-plugins">Events</a></li>
		<li><a href="writing-transition-plugins">Transitions</a></li>
	</ul>
</section>

<section>
	<h1>Specific versions</h1>

	<ul>
		<li><a href='../edge'>edge</a></li>
		<li><a href='../0.7'>0.7</a></li>
		<li><a href='../0.6'>0.6</a></li>
		<li><a href='../0.5'>0.5</a></li>
		<li><a href='../0.4.0'>0.4.0</a></li>
		<li><a href='../0.3.9'>0.3.9</a></li>
	</ul>
</section>

		</aside>
	</main>

	<footer>
	<p>Ractive.js is a free and open source project released under the MIT license.</p>
</footer>


	<script>
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

	ga('create', 'UA-5602942-6', 'ractivejs.org');
	ga('send', 'pageview');
</script>


	<script src='../assets/nav.js'></script>

</body>
</html>
